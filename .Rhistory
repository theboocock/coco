print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1))
print(res_preparation$data_set$rsid[top_idx])
ld_row = res_preparation$ld_matrix[top_idx,]^2
ld_cut = cut(ld_row,breaks=c(0,.2,.4,.6,.8,1.0))
plotting_data = data.frame(p_logs=p_logs,pos=res_preparation$data_set$pos,ld_cut=ld_cut, highlight_top=fact_top)
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1))
i.
i = 1
i = 1
top_idx = which(max(abs(res_preparation$data_set$z)) == abs(res_preparation$data_set$z))[1]
p_logs= -log10(2*pnorm(abs(res_preparation$data_set$z), lower.tail=F))
max_p = max(p_logs,na.rm=T)
fact_top = max(abs(res_preparation$data_set$z)) == abs(res_preparation$data_set$z)
ld_row = res_preparation$ld_matrix[top_idx,]^2
ld_cut = cut(ld_row,breaks=c(0,.2,.4,.6,.8,1.0))
plotting_data = data.frame(p_logs=p_logs,pos=res_preparation$data_set$pos,ld_cut=ld_cut, highlight_top=fact_top)
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1))
source('~/Sinai/corrcond/R/coco_plot.R')
highlight_points = data.frame(rsid=stepwise_results$stepwise_summary$rsid,
pos=res_preparation$data_set$rsid[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)],
p_logs = p_logs[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)]
)
highlight_points
match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)
res_preparation$data_set$rsid
stepwise_results$stepwise_summary$rsid
match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)
match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)
stepwise_results$stepwise_summary$rsid %in% res_preparation$data_set$rsid
stepwise_results$stepwise_summary$rsid[1] %in% res_preparation$data_set$rsid
res_preparation$data_set$rsid
a =prep_dataset_coco(abcg2_data,abcg2_ld,var_y = 1.6421)
res_preparation = a
match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)
highlight_points = data.frame(rsid=stepwise_results$stepwise_summary$rsid,
pos=res_preparation$data_set$rsid[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)],
p_logs = p_logs[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)]
)
highlight_points
highlight_points = data.frame(rsid=stepwise_results$stepwise_summary$rsid,
pos=res_preparation$data_set$pos[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)],
p_logs = p_logs[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)]
)
highlight_points
p_logs= -log10(2*pnorm(abs(res_preparation$data_set$z), lower.tail=F))
p_logs
highlight_points = data.frame(rsid=stepwise_results$stepwise_summary$rsid,
pos=res_preparation$data_set$pos[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)],
p_logs = p_logs[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)]
)
highlight_points
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,shape=highlight_points$p_logs))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,shape=highlight_points$p_logs)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,shape=highlight_points$rsid)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,fill=highlight_points$rsid)))
}
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,fill=rsid)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos,)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos)))
highlight_points %>% ggplot(aes(y=p_logs,x=pos)) + geom_point()
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=highlight_points$p_logs,x=highlight_points$pos)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(aes(y=highlight_points$p_logs,x=highlight_points$pos)))
source('~/Sinai/corrcond/R/coco_plot.R')
plotting_data = data.frame(p_logs=p_logs,pos=res_preparation$data_set$pos,ld_cut=ld_cut, highlight_top=fact_top)
highlight_points = data.frame(rsid=stepwise_results$stepwise_summary$rsid,
pos=res_preparation$data_set$pos[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)],
p_logs = p_logs[match(stepwise_results$stepwise_summary$rsid,res_preparation$data_set$rsid)]
)
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=highlight_points,aes(y=p_logs,x=pos)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD")
geom_point(data=highlight_points,aes(y=p_logs,x=pos)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos)))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos)))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos, colour=pos))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos, fill=pos))
plotting_data %>% ggplot(aes(y=p_logs,x=pos)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") +
geom_point(data=highlight_points,aes(y=p_logs,x=pos, fill=pos))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
step$step_betas[[1]]$res_step
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
dim(res_preparation$data_set)
dim(step)
dim(step$step_betas[[1]]$res_step)
res_preparation = prep_dataset_coco(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F,var_y=0.019431651487353568397,exact = T)
step = stepwise_coco(res_preparation, joint=F,return_all_betas = T)
plot_stepwise(res_preparation, step)
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
nrow(stepwise_results$stepwise_summary)
nrow(stepwise_results$stepwise_summary)
source('~/Sinai/corrcond/R/coco_plot.R')
nrow(stepwise_results$stepwise_summary)
plot_stepwise(res_preparation, step, one_per_step = F)
dim(res_preparation)
dim(res_preparation$data_set)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
dev.off()
plot_stepwise(res_preparation, step, one_per_step = F)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
res_preparation$data_set$rsid == "rs4417927"
which(res_preparation$data_set$rsid == "rs4417927")
source('~/Sinai/corrcond/R/coco_plot.R')
which(res_preparation$data_set$rsid == "rs4417927")
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step, one_per_step = F)
library(data.table)
library(CoCo)
slc2a9_ld = as.matrix(fread("data2/slc2a9_only.ld"))
slc2a9_freq = fread("data2/slc2a9_only.frq", header=T)
slc2a9_stats = fread("data2/slc2a9_summary.txt", header=F)
slc2a9_bim = fread("data2/slc2a9_only.bim", header=F)
slc2a9_data = merge(slc2a9_stats,slc2a9_freq,by.x="V1",by.y="SNP")
colnames(slc2a9_data)[1:13] = c("RSID","A1_X","A2_X","FREQ1","FREQ_SE","EFFECT","SE","P","study","GC","NSTUDY","SOMETHING","N")
slca9_data = merge(slc2a9_data,slc2a9_bim,by.x="RSID",by.y="V2")
colnames(slca9_data)[which(colnames(slca9_data) == "V4")] = "POS"
a =prep_dataset_coco(slca9_data,slc2a9_ld,var_y = 1.6421)
# g = stepwise_coco(a,exact=T)
#g = stepwise_coco(a,exact=F,joint = F,max_iter = 5)
g1 = stepwise_coco(a,exact=F,joint = F,p_value_threshold = 9.186111e-06,max_iter = 18,colinear_threshold = 0.9,return_all_betas = T)
9
9
9
colnames(slc2a9_data)[1:13] = c("RSID","A1_X","A2_X","FREQ1","FREQ_SE","EFFECT","SE","P","study","GC","NSTUDY","SOMETHING","N")
slca9_data = merge(slc2a9_data,slc2a9_bim,by.x="RSID",by.y="V2")
colnames(slca9_data)[which(colnames(slca9_data) == "V4")] = "POS"
a =prep_dataset_coco(slca9_data,slc2a9_ld,var_y = 1.6421)
g1 = stepwise_coco(a,exact=F,joint = F,p_value_threshold = 9.186111e-06,max_iter = 18,colinear_threshold = 0.9,return_all_betas = T)
g1 = stepwise_coco(a,joint = F,p_value_threshold = 9.186111e-06,max_iter = 5,colinear_threshold = 0.9,return_all_betas = T)
plot_stepwise(a,g1)
g1 = stepwise_coco(a,joint = F,p_value_threshold = 9.186111e-06,max_iter = 5,colinear_threshold = 0.9,return_all_betas = T)
g1$stepwise_summary
a$data_set
plot_stepwise(a,g1)
source('~/.active-rstudio-document', echo=TRUE)
g1 = stepwise_coco(a,joint = F,p_value_threshold = 9.186111e-06,max_iter = 5,colinear_threshold = 0.9,return_all_betas = T)
plot_stepwise(a,g1)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(a,g1)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(a,g1)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(a,g1)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(a,g1)
plot_stepwise(a,g1,z_plot = T)
plot_stepwise(a,g1,z_plot = T)
plot_stepwise(a,g1,z_plot = T)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(a,g1,z_plot = T)
source('~/Sinai/corrcond/R/coco_plot.R')
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(factor(rsid)))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(factor(rsid))))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= factor(rsid))))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= (rsid))))
print(plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= rsid)))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= rsid)))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= rsid))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= plotting_data$rsid))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_label(data=plotting_data[top_idx,],aes(fill= plotting_data[top_idx,]$rsid))
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1)) + geom_point(data=plotting_data[top_idx],aes(y=p_logs,x=pos))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx],aes(y=p_logs,x=pos))
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos))
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), size="5",shape="diamond")
source('~/Sinai/corrcond/R/coco_plot.R')
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), size="5",shape="b")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), size="5",shape=b)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), size="5",shape=b)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos,shape=b), size="5")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos,shape=2), size="5")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos,shape=rsid), size="5")
plotting_data
head(plotting_data)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos,shape=highlight_top), size="5")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos,shape=factor(highlight_top)), size="5")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=15
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) + geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=15)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=15,size=20)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=3,size=20)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=4,size=20)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=24,size=20)
t()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=23,size=20)
print(
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=23,size=20)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=03,size=20)
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=18,size=20,colour="blue")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=18,size=3,colour="blue")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=18,size=3,colour="purple")
plotting_data %>% ggplot(aes(y=p_logs,x=pos,colour=ld_cut)) + geom_point()  + theme_bw() + ggtitle(res_preparation$data_set$rsid[top_idx]) +
ylab("-Log10 P-value") + xlab("Genomic Position") + scale_colour_discrete(name="Pair-wise LD") + ylim(0,max_p + 1) +
geom_point(data=plotting_data[top_idx,],aes(y=p_logs,x=pos), shape=18,size=4,colour="purple")
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step)
plot_stepwise(res_preparation, step,z_plot = T)
plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step,one_per_step = F)
plot_stepwise(res_preparation, step,one_per_step = F)
plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
dat = source('~/Sinai/corrcond/R/coco_plot.R')
dat$value()
dat[[1]]
dat = source('~/Sinai/corrcond/R/coco_plot.R')
dat = plot_stepwise(res_preparation, step,one_per_step = F)Ã¥
dat = plot_stepwise(res_preparation, step,one_per_step = F)
dat$data
plot(dat)
plot(dat[[1]])
dat
length(dat)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
dat = plot_stepwise(res_preparation, step,one_per_step = F)
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
dat = plot_stepwise(res_preparation, step,one_per_step = F)
dat
dat[[1]]
length(dat)
library(gridExtra)
grid.arrange(dat)
grid.arrange(dat)
grid.arrange(dat[[1]],dat[[2]],dat[[3]])
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
grid.arrange(dat[[1]],dat[[2]],dat[[3]])
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
source('~/Sinai/corrcond/R/coco_plot.R')
dat = plot_stepwise(res_preparation, step,one_per_step = F)
grid.arrange(dat[[1]],dat[[2]],dat[[3]])
source("R/corrcond.R")
library(data.table)
library(CoCo)
librayr(Coco)
library(coco )
source("R/corrcond.R")
library(data.table)
source("R/symmetrcize.R")
source("R/estimate_betas.R")
ld_matrix = as.matrix(fread("data2/CM6_Cauc-NEK1_imputed-LDcorr5523.ld", header=F))
qnorm(p = .05)
qnorm(p = .05)
qnorm(p = .025)
qnorm(p = .05/2)
z1= qnorm(p = .05/2)
z2= qnorm(p = .05/2)
z1= qnorm(p = .05/2)
z2= qnorm(p = .05/2)
test_statistic = z1^2*z2^2/(z1^2 + z2^2)
test_statistic
pchisq(test_statistic)
pchisq(test_statistic,df=1)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .05/2)
z2= qnorm(p = .05/2)
test_statistic = z1^2*z2^2/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .05/2)
z2= qnorm(p = .0001/2)
test_statistic = z1^2*z2^2/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = .0001/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-8/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = 1e-8/2)
z2= qnorm(p = 1e-8/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .005/2)
z2= qnorm(p = 1e-8/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .05/2)
z2= qnorm(p = 1e-8/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .05/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .05/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
z1= qnorm(p = .0005/2)
z2= qnorm(p = 1e-139/2)
test_statistic = (z1^2*z2^2)/(z1^2 + z2^2)
pchisq(test_statistic,df=1,lower.tail = F)
